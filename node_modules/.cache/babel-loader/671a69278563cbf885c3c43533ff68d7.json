{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Desktop/aatf-views-very-last/src/views/auth/login.tsx\";\nimport React, { useState } from \"react\";\nimport { Card, Form, FormGroup, Input, Button } from \"reactstrap\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { useMutate } from \"restful-react\";\nimport Loading from \"components/Loading\";\nexport const successSubmit = resp => {\n  let response = resp;\n  localStorage.setItem(\"token\", response.token);\n  localStorage.setItem(\"role\", response.user.role);\n  localStorage.setItem(\"nom\", response.user.nom);\n  localStorage.setItem(\"prenom\", response.user.prenom);\n  return true;\n};\nexport default function LoginForm() {\n  const history = useHistory();\n  const [user, setUser] = useState({});\n\n  const SubmitButton = () => {\n    const {\n      mutate,\n      loading,\n      error\n    } = useMutate({\n      verb: \"POST\",\n      path: \"/users/login\"\n    });\n\n    const submit = e => {\n      e.preventDefault();\n      mutate(user).then(resp => {\n        if (successSubmit(resp)) history.push(\"/admin\");\n      });\n    };\n\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 7\n      }\n    }, loading && /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 21\n      }\n    }), error && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 19\n      }\n    }, \"Login incorrect.\"), mutate && /*#__PURE__*/React.createElement(Button, {\n      className: \"auth-submit\",\n      onClick: submit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 11\n      }\n    }, \"Login\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"form-card centered\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }\n  }, \"Login\")), /*#__PURE__*/React.createElement(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    autoFocus: true,\n    id: \"matricleField\",\n    placeholder: \"Matricule\",\n    value: user.matricule,\n    onChange: e => setUser({ ...user,\n      matricule: e.target.value\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    type: \"password\",\n    id: \"passwordField\",\n    placeholder: \"Password\",\n    value: user.password,\n    onChange: e => setUser({ ...user,\n      password: e.target.value\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(SubmitButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 11\n    }\n  }, \"You dont have an account?\", \" \", /*#__PURE__*/React.createElement(Link, {\n    to: \"/auth/register\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }\n  }, \"Create one here\")))));\n}","map":{"version":3,"sources":["/Users/mac/Desktop/aatf-views-very-last/src/views/auth/login.tsx"],"names":["React","useState","Card","Form","FormGroup","Input","Button","Link","useHistory","useMutate","Loading","successSubmit","resp","response","localStorage","setItem","token","user","role","nom","prenom","LoginForm","history","setUser","SubmitButton","mutate","loading","error","verb","path","submit","e","preventDefault","then","push","matricule","target","value","password"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { Card, Form, FormGroup, Input, Button } from \"reactstrap\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { Login } from \"models/user\";\r\nimport { useMutate } from \"restful-react\";\r\nimport Loading from \"components/Loading\";\r\n\r\nexport const successSubmit = (resp: any) => {\r\n  let response = resp as {\r\n    user: { role: string; prenom: string; nom: string };\r\n    token: string;\r\n  };\r\n  localStorage.setItem(\"token\", response.token);\r\n  localStorage.setItem(\"role\", response.user.role);\r\n  localStorage.setItem(\"nom\", response.user.nom);\r\n  localStorage.setItem(\"prenom\", response.user.prenom);\r\n\r\n  return true;\r\n};\r\n\r\nexport default function LoginForm() {\r\n  const history = useHistory();\r\n  const [user, setUser] = useState<Login>({} as Login);\r\n\r\n  const SubmitButton = () => {\r\n    const { mutate, loading, error } = useMutate({\r\n      verb: \"POST\",\r\n      path: \"/users/login\",\r\n    });\r\n\r\n    const submit = (e: React.MouseEvent) => {\r\n      e.preventDefault();\r\n      mutate(user).then((resp) => {\r\n        if (successSubmit(resp)) history.push(\"/admin\");\r\n      });\r\n    };\r\n\r\n    return (\r\n      <React.Fragment>\r\n        {loading && <Loading />}\r\n        {error && <p>Login incorrect.</p>}\r\n        {mutate && (\r\n          <Button className='auth-submit' onClick={submit}>\r\n            Login\r\n          </Button>\r\n        )}\r\n      </React.Fragment>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className='text-center'>\r\n      <Card className='form-card centered'>\r\n        <Form>\r\n          <FormGroup>\r\n            <h5>Login</h5>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Input\r\n              autoFocus\r\n              id='matricleField'\r\n              placeholder='Matricule'\r\n              value={user.matricule}\r\n              onChange={(e) => setUser({ ...user, matricule: e.target.value })}\r\n            />\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Input\r\n              type='password'\r\n              id='passwordField'\r\n              placeholder='Password'\r\n              value={user.password}\r\n              onChange={(e) => setUser({ ...user, password: e.target.value })}\r\n            />\r\n          </FormGroup>\r\n          <SubmitButton />\r\n          <p>\r\n            You dont have an account?{\" \"}\r\n            <Link to='/auth/register'>Create one here</Link>\r\n          </p>\r\n        </Form>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}